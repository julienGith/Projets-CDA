@model OPS2020.Models.QuestionnaireModel

@{
    ViewData["Title"] = "Quest";
}


<style>
    .rotate {
        -moz-transition: all .2s linear;
        -webkit-transition: all .2s linear;
        transition: all .2s linear;
    }

    .questIntitule {
        width: 350px;
        overflow-x: scroll;
        overflow-x: hidden;
    }

    .rotate.down {
        -ms-transform: rotate(180deg);
        -moz-transform: rotate(180deg);
        -webkit-transform: rotate(180deg);
        transform: rotate(180deg);
    }

    ul {
        list-style-type: none;
    }

    a.disabled {
        pointer-events: none;
        cursor: default;
    }
</style>
<div class="col-sm">
    <h1>@Model.codeProduitFormation @Model.LibelleProduitFormation</h1>
    <div class="row justify-content-end">
        <input type="button" class="btn btn-sm btn-success mr-3" id="BtnEnregistrer" value="Sauvegarder le questionnaire" />
    </div>
    <div class="card">
        <div class="card-header">Création d'un questionnaire</div>
        <div class="card-body">
            <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                    <a class="nav-item nav-link active" id="nav-prop-tab" data-toggle="tab" href="#nav-prop" role="tab" aria-controls="nav-prop" aria-selected="true">Propriétés du questionnaire</a>
                    <a class="nav-item nav-link" id="nav-questions-tab" data-toggle="tab" href="#nav-questions" role="tab" aria-controls="nav-questions" aria-selected="false">Questions du questionnaire</a>
                    <a class="nav-item nav-link" id="nav-preview-tab" data-toggle="tab" href="#nav-preview" role="tab" aria-controls="nav-preview" aria-selected="false">Aperçu du questionnaire</a>
                </div>
            </nav>
            <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-prop" role="tabpanel" aria-labelledby="nav-prop-tab">
                    <label for="titreTxtB">Titre du questionnaire</label>
                    <input id="titreTxtB" type="text" class="form-control" placeholder="Titre">
                    <label for="libelTxtB">Description du questionnaire</label>
                    <textarea class="form-control" placeholder="Description" name="descriptionTxtA" rows="5" id="descriptionTxtA"></textarea>
                    <input id="BtnValider" type="button" name="BtnValider" value="Créer" class="btn btn-primary right" />
                </div>
                <div class="tab-pane fade" id="nav-questions" role="tabpanel" aria-labelledby="nav-questions-tab">
                    <div class="row"> <div id="titreDiv" class="card-header text-center flex-fill">Validez les propriétés du questionnaire le titre apparaîtra ici</div></div>
                    <div class="row">
                        <div class="col-sm">
                            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                                <button class="navbar-toggler btn btn-light btn-block" type="button" data-toggle="collapse" data-target="#navbarSupportedContent1" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                                    <span>Type de question</span>&emsp;&emsp;&emsp;<span class="navbar-toggler-icon float-right"></span>
                                </button>
                                <div class="collapse navbar-collapse" id="navbarSupportedContent1">
                                    <ul class="navbar-nav flex-md-column flex-fill">
                                        <li id="BtnOuiNon" name="Btn1a10" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Choisir entre oui et non</li>
                                        <li id="BtnOuiNonNsp" name="BtnOuiNonNsp" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Choisir entre oui, non et Ne sais pas</li>
                                        <li id="BtnTxtC" name="BtnTxtC" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Répondre sous forme de texte court</li>
                                        <li id="BtnTxtL" name="BtnTxtL" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Répondre sous forme de texte long</li>
                                        <li id="BtnValNum" name="BtnValNum" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Répondre sous forme d'une valeur numérique</li>
                                        <li id="Btn4niv" name="Btn4niv" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Evaluer selon 4 niveaux de satisfaction</li>
                                        <li id="Btn1a10" name="Btn1a10" class="btn btn-light btn-sm nav-item" data-toggle="modal" data-target="#questionModal">Evaluer selon une échelle de 1 à 10</li>
                                        <li id="Btn1rep" name="Btn1rep" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Choisir une seule réponse au sein d'un groupe de choix</li>
                                        <li id="BtnNrep" name="BtnNrep" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Choisir plusieurs réponses au sein d'un groupe de choix</li>
                                        <li id="Btn1repListe" name="Btn1repListe" class="btn btn-light btn-sm btn-block nav-item" data-toggle="modal" data-target="#questionModal">Choisir une seule réponse au sein liste</li>
                                    </ul>
                                </div>
                            </nav>
                        </div>
                        <div class="col-sm">
                            <ul id="sortable" class="navbar-nav flex-md-column flex-fill">
                            </ul>
                            <div id="ordre"><button id="ordreBtn"></button>   </div>
                        </div>
                    </div>
                </div>
                <div class="tab-pane fade" id="nav-preview" role="tabpanel" aria-labelledby="nav-preview-tab">
                    <div id="previewQuestionnaire">
                        <form class="form-horizontal col align-self-center">
                            <fieldset>
                                <legend id="formName">Form Name</legend>
                                <div id="previewQuestions">


                                </div>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="questionModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Ajout De question</h4>
            </div>
            <div class="modal-body">
                <label for="intituleTxtB">Intitulé de la question :</label>
                <input class="form-control" placeholder="Intitulé" type="text" id="intituleModalTxtB" />
            </div>
            <div class="modal-footer">
                <button id="modalIntituleBtn" type="button" class="btn btn-default" data-dismiss="modal">Valider</button>
            </div>
        </div>
    </div>
</div>

<div id="supprModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Suppression de question</h4>
            </div>
            <div class="modal-body">
                <label for="intituleTxtB">Voulez-vous supprimer la question ?</label>
            </div>
            <div class="modal-footer">
                <button id="modalSupprBtn" type="button" class="btn btn-default" data-dismiss="modal">Supprimer</button>
                <button id="modalAnnulBtn" type="button" class="btn btn-default" data-dismiss="modal">Annuler</button>
            </div>
        </div>
    </div>
</div>
<span id="idQuestionnaire"  data-count="@Model.questionnaireId"></span>
<script>

    //$('#sortable').sortable();



    $(document.body).on('click', '.element', function (e) { });
    $(document.body).on('click', '.element', function (e) { });




    //$(document.body).on('click', '.rotate', function () { $(this).toggleClass("down"); });

    $(document).ready(function () {
       // "use strict";
        $(document.body).on('click', '#ordreBtn', function () {
            //alert($("#sortable").sortable('toArray'));
            //C(productOrder);
            C("Test Toggle");

            $("#toggle1").wrap("<div class='radio'></div>");
            $("#toggle2").wrap("<div class='radio'></div>");
        })

        var C = console.log;

        var numQuestion = 0;
        var codeQuestion;
        var type;
        var choixRequis;
        var ajoutSupprChoix;
        var questionnaire = {
            codeProduitFormation: '',
            questionnaireId: '',
            titreQuestionnaire: '',
            description: '',
            dataJson: [''],
            etatQuestionnaire: '',
            codeHtml: '',
            listQuestObj: ['']
        }
        C(@Model.questionnaireId);
        //Chargement du questionnaire
        $(document.body).ready(function () {
            if ($("#idQuestionnaire").data("count") != 0) {
                C("Chargement questionnaire");
                questionnaire = @Html.Raw(Json.Serialize(Model));
                // Remplissage propriétés du questionnaire
                $("#titreTxtB").val(questionnaire.titreQuestionnaire);
                $("#descriptionTxtA").val(questionnaire.description);
                $("#formName").html(questionnaire.titreQuestionnaire);
                $("#titreDiv").html(questionnaire.titreQuestionnaire);
                C(questionnaire);
                questionnaire.listQuestObj = filter_array_values(questionnaire.listQuestObj);
                C("liste questionOBJ", questionnaire.listQuestObj);
                // Boucle chargement question
                for (let x of questionnaire.listQuestObj) {
                    C("Boucle chargement");
                    CreerQuestion(x);
                    $(document.body).ready(function () {
                    if (x.requis == false) {
                        let idRadioOreq = "#" + x.requisOuiRadioId;
                        let idRadioNreq = "#" + x.requisNonRadioId;
                        C("ID requis : ",idRadioNreq);
                        $(idRadioOreq).prop('checked', false);
                        $(idRadioNreq).prop('checked', true);
                    }
                    if (x.graphique == 2) {
                        let idDdlGraph = "#" + x.graphiqueId;
                        $(idDdlGraph).find(':selected').prop('selected', false);
                        $(idDdlGraph).find("option[value='2']").prop('selected', true);
                    }
                    })

                    AppendPrev(x);
                    x.listUserItems = filter_array_values(x.listUserItems);
                    C("liste usersItem", x.listUserItems);
                    // Boucle Chargement des items de la question en cours
                    for (let y of x.listUserItems) {
                        C("Boucle chargement usertItems");
                        C("UserItem", y);
                        if (x.modifUser = true) {
                            $(document.body).ready(function () {
                                $(".exemple").remove();
                                $(".exemplechk").remove();
                                $(".exemplelst").remove();
                            let idUl = "";
                            let idListItem = "";
                            let lblPrev = "";
                                let txtBintituleId = "";
                                CreerItemPreview(x,y);
                            idUl = "#" + x.itemUlId;
                            lblPrev = "#" + y.itemPrev.lbl;
                            txtBintituleId = "#" + y.txtBId;
                            $(idUl).append(y.codeHtml);
                            $(lblPrev).append(y.intitule);
                            $(txtBintituleId).val(y.intitule);
                                C("Intitule", y.intitule);
                            })
                        }
                    }
                }
            }
        })
        // Evènement sur les controls html générés
        // Animation flêche dépliage propriétés de la question
        $(document.body).on('click', '.rotate', function () { $(this).toggleClass("down"); });
        // Suppression d'une valeur possible ajouté par l'utilisateur
        $(document.body).on('click', '.suppr-item', function () {
            let questionObj = new QuestionObj();
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            var toto = $(this).attr("id");
            C("USerItem Id :",toto);

            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            C("avant pop",questionObj);
            let userItemId = $(this).attr("id");
            let userItem = new UserItem();
            userItem = questionObj.listUserItems.find(u => u.id === userItemId);
            C("liste userItem avant le pop :",questionObj.listUserItems);
            let item = new Item();
            item = userItem.itemPrev;
            let userItemIdS = "#" + $(this).attr("id");
            var idLabel = "#" + item.lbl;
            if (questionObj.type == "1rep") {
                $(idLabel).parent().remove();
            }
            if (questionObj.type == "Nrep") {

                $(idLabel).parent().remove();
            }
            if (questionObj.type == "1repListe") {
                C("avant remove", idLabel)
                $(idLabel).remove();
            }
            $(userItemIdS).parent().parent().parent('li').remove();
            C(userItemId);
            questionObj.listUserItems = questionObj.listUserItems.filter(u => u.id !== userItem.id)
            C("liste userItem après le pop :", questionObj.listUserItems);
            SetCookieQuestionnaire(questionnaire);
        });
        // Modification d'une valeur possible
        $(document.body).on('keyup', '.item-text', function () {
            let questionObj = new QuestionObj();
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            C(questionObj);
            C(questionObj.listUserItems);
            let idTxtB = $(this).attr("id");
            let userItem = new UserItem();
            userItem = questionObj.listUserItems.find(u => u.txtBId === idTxtB);
            C("idtxt", idTxtB);
            C("userItem noFake", userItem);
            let lblPrev = "#" + userItem.itemPrev.lbl;
            let userTxtB = "#" + idTxtB;
            let itemText = $(userTxtB).val();
            C(lblPrev);
            $(lblPrev).empty();
            $(lblPrev).append(itemText);
            userItem.intitule = itemText;
            C("intitule useritem", userItem.intitule)
            //questionObj.listUserItems.pop(userItem);
            //questionObj.listUserItems.push(userItem);
            //SetCookieQuestionnaire(questionnaire);
        });
        // Ajout d'une valeur possible
        $(document.body).on('click', '.ajout-radio', function () {

            let questionObj = new QuestionObj();
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            let userItem = new UserItem(codeQuestion);
            C("list quest", questionnaire.listQuestObj)
            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            C("QuestionObj pour le pop :", questionObj)
            C("id txtB", userItem.TxtBId);
            questionObj.modifUser = true;
            questionObj.listItems = [''];
            let item = new Item(questionObj.questionId);
            item.id = userItem.IdPreview;
            userItem.itemPrev = item;
            C("Ajout User item objs transmis : ", questionObj, userItem);
            questionObj.listUserItems.push(userItem);
            SetCookieQuestionnaire(questionnaire);
            CreerUserItem(questionObj, userItem);
            CreerItemPreview(questionObj, userItem);
        })
        // Suppression question
        $(document.body).on('click', '.trash', function () {
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            C(codeQuestion);
        })
        // Modification du caractère requis de la question
        $(document.body).on('click', '.requis', function () {
            let questionObj = new QuestionObj();
            let qpreview = '';
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            for (var i = 0; i < questionnaire.listQuestObj.length; i++) {
                if (questionnaire.listQuestObj[i].questionId == codeQuestion) {
                    questionObj = questionnaire.listQuestObj[i];
                    C(questionnaire.listQuestObj[i]);
                }
            }
            questionObj.requis = $(this).val();
            C("objet transmis", questionObj);
            if (questionObj.modifUser == true)
            {
                    CreerItemPreview(questionObj);
            }
            else {
                CreerPreview(questionObj);
            }


        })
        // Modification de l'aperçu de l'intitulé de la question
        $(document.body).on('change', '.intituleTxtB', function () {
            let qpreview = '';
            let intituleBtn = '';
            let intitule = '';
            let intituleDivB = '';
            let questionObj = new QuestionObj();
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            intituleBtn = "#" + $(this).attr("id");
            intituleDivB = "#intitule" + codeQuestion + "Div";
            $(intituleDivB).html('');
            intitule = $(intituleBtn).val();
            $(intituleDivB).html(intitule);
            questionObj.intitule = intitule;
            CreerPreview(questionObj);
            SetCookieQuestionnaire(questionnaire);

        })
        // Modification de l'intitulé de la question dans la fenêtre de gestion
        $(document.body).on('keyup', '.intituleTxtB', function () {
            let qpreview = '';
            let intituleBtn = '';
            let intitule = '';
            let intituleDivB = '';
            let questionObj = new QuestionObj();
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            intituleBtn = "#" + $(this).attr("id");
            intituleDivB = "#intitule" + codeQuestion + "Div";
            $(intituleDivB).html('');
            intitule = $(intituleBtn).val();
            $(intituleDivB).html(intitule);
            questionObj.intitule = intitule;
        })
        // Modification du graphique de la restitution de la réponse
        $(document.body).on('change', '.graphOption', function () {
            let questionObj = new QuestionObj();
            let value = '';
            codeQuestion = ExtraireCodeQuestion($(this).attr("id"));
            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            value = $(this).val();
            questionObj.graphique = value;
            C("Graph queston obj :", questionObj);
            if (questionObj.modifUser == true) {
                //CreerItemPreview(questionObj);
            }
            else {
                //CreerPreview(questionObj);
            }
            SetCookieQuestionnaire(questionnaire);

            C("obj graph =", questionObj.graphique, "valeur du control =", value);
            C("objet transmis",questionObj);

        })
        // Evènement Boutons
        // bouton de la modal de suppression de question
        $("#modalSupprBtn").click(function () {
            let questionObj = new QuestionObj();
            let divPosPrevId = '';
            let idLiQuestion = '';
            questionObj = questionnaire.listQuestObj.find(c => c.questionId === codeQuestion);
            var removeIndex = questionnaire.listQuestObj.map(function (item) { return item.questionId; }).indexOf(codeQuestion);
            questionPreviewId = "questionPreview" + questionObj.questionId;
            idLiQuestion = "#" + questionObj.questionId;
            $(idLiQuestion).remove();
            C(questionObj.questionPreviewId);
            divPosPrevId = "#" + questionObj.divPosPrev;
            questionnaire.listQuestObj.splice(removeIndex, 1);
            SetCookieQuestionnaire(questionnaire);
            $(divPosPrevId).remove();
            C(questionnaire.listQuestObj);
        })
        // enregistrement du questionnaire
        $("#BtnEnregistrer").click(function () {
            questionnaire.codeProduitFormation = @Model.codeProduitFormation;
            questionnaire.etatQuestionnaire = 0;
            questionnaire.dataJson = "vide";
            let previewQuest = $("#previewQuestionnaire").html();
            let codeHtml = $("#previewQuestions").html();
            questionnaire.codeHtml=codeHtml;
            EnregistrerQuestionnaire(questionnaire);
        })
        // création des propriétés du questionnaire
        $("#BtnValider").click(function () {
            ////OBJET Quest
            let titre = '';
            let description = '';
            titre = $("#titreTxtB").val();
            description = $("#descriptionTxtA").val();
            $("#formName").html(titre);
            questionnaire.titreQuestionnaire = titre;
            questionnaire.description = description;
            questionnaire.codeProduitFormation = @Model.codeProduitFormation;
            questionnaire.etatQuestionnaire = 0;
            questionnaire.dataJson = "vide";
            $("#titreDiv").html(titre);
            //CreerQuestionnaire(questionnaire);
            alert("Questionnaire " + titre + " créé.");
            SetCookieQuestionnaire(questionnaire);
        })
        // bouton de sélection du type de question
        $("#Btn1repListe").click(function () {
            type = "1repListe";
            choixRequis = true;
            ajoutSupprChoix = true;
        })
        $("#BtnNrep").click(function () {
            type = "Nrep";
            choixRequis = true;
            ajoutSupprChoix = true;
        })
        $("#Btn4niv").click(function () {
            type = "4niv";
            choixRequis = true;
            ajoutSupprChoix = true;
        })
        $("#BtnValNum").click(function () {
            type = "ValNum";
            choixRequis = true;
            ajoutSupprChoix = false;
        })
        $("#Btn1rep").click(function () {
            type = "1rep";
            choixRequis = true;
            ajoutSupprChoix = true;
        })
        $("#BtnTxtL").click(function () {
            type = "TxtL";
            choixRequis = true;
            ajoutSupprChoix = false;
        })
        $("#BtnTxtC").click(function () {
            type = "TxtC";
            choixRequis = true;
            ajoutSupprChoix = false;
        })
        $("#BtnOuiNonNsp").click(function () {
            type = "OuiNonNsp";
            choixRequis = true;
            ajoutSupprChoix = false;
        })
        $("#BtnOuiNon").click(function () {
            type = "OuiNon";
            choixRequis = true;
            ajoutSupprChoix = false;
        })
        $("#Btn1a10").click(function () {
            type  = "1a10";
            choixRequis = true;
            ajoutSupprChoix = false;
        })
        // Bouton de la modal d'ajout de question
        // crée l'objet questionObj
        $("#modalIntituleBtn").click(function () {
            C(type);

            $(document.body).ready(function () {
                numQuestion += 1;
                var numQ = $("#sortable").children().length + 1;
                var intitule = '';
                var nombreDeLi = $("#sortable").children().length;
                intitule = $("#intituleModalTxtB").val();
                codeQuestion = String(numQuestion) + String(nombreDeLi) + String(Math.floor((Math.random() * 100) + 1));
                let questionObj = new QuestionObj(type, choixRequis, ajoutSupprChoix, intitule, codeQuestion, numQ);
                questionnaire.listQuestObj.push(questionObj);
                SetCookieQuestionnaire(questionnaire);
                CreerQuestion(questionObj);
                CreerPreview(questionObj);
                $("#intituleModalTxtB").val('');
            });
        })
        // Fontions de l'interface
        // Fonctions qui génèrent le code html des questions
        // Génère le code html pour les valeurs possibles ajoutés par l'utilisateur
        function CreerUserItem(questionObj, userItem) {
            let idUl = "#" + questionObj.itemUlId;
            if (questionObj.type == "Nrep") {
                userItem.codeHtml = "<li class='list-inline-item form-inline justify-content-center mb-2'>" +
                    "<div class='d-inline'><input type='checkbox' name='item' class='ml-2' disabled/></div>" +
                    "<div class='d-inline'><input class='form-control item-text' id=" + userItem.txtBId + " type='text'/></div> <div class='d-inline ml-2'>" +
                    "<button><i href='#' id=" + userItem.id + " class='fas fa-trash-alt suppr-item'></i></button></div ></li> ";
                $(".exemplechk").fadeOut(400, function () { $(this).remove(); });
                $(idUl).fadeIn(300, function () {
                    $(this).append(userItem.codeHtml);
                });
            }
            if (questionObj.type == "1rep") {
                userItem.codeHtml = "<li class='list-inline-item form-inline justify-content-center mb-2'>" +
                    "<div class='d-inline'><input type='radio' name='item' class='ml-2' disabled/></div>" +
                    "<div class='d-inline'><input class='form-control item-text' id=" + userItem.txtBId + " type='text'/></div> <div class='d-inline ml-2'>" +
                    "<button><i href='#' id=" + userItem.id + " class='fas fa-trash-alt suppr-item'></i></button></div ></li> ";
                $(".exemple").fadeOut(400, function () { $(this).remove(); });
                $(idUl).fadeIn(300, function () {
                    $(this).append(userItem.codeHtml);
                });
            }
            if (questionObj.type == "1repListe") {
                userItem.codeHtml = "<li class='list-inline-item form-inline justify-content-center mb-2'>" +
                    "<div class='d-inline'><input type='radio' name='item' class='ml-2' disabled/></div>" +
                    "<div class='d-inline'><input class='form-control item-text' id=" + userItem.txtBId + " type='text'/></div> <div class='d-inline ml-2'>" +
                    "<button><i href='#' id=" + userItem.id + " class='fas fa-trash-alt suppr-item'></i></button></div ></li> ";
                $(idUl).fadeIn(300, function () {
                    $(this).append(userItem.codeHtml);
                    $(".exemplelst").remove();
                });
            }
        }
        // Génère le code html pour la card de gestion de la question
        function CreerQuestion(questionObj) {
            C("objet reçu", questionObj);
            C("CreaQuest type : ", questionObj.type);
            C("targetID",questionObj.targetId);
            if (questionObj.type == "1repListe") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div id=" + questionObj.targetId + " class='collapse'>" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption' disabled>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm ajout-radio' id=" + questionObj.ajouterBtnId + "/></div></div>" +
                    "<div class='col-md- 4'>"+
                    "<select id='selectbasic' name='selectbasic' class='form-control' disabled >"+
                    "<option value='1'>Option one</option>"+
                    "<option value='2'>Option two</option>"+
                    "</select>" +
                    "<ul class='pl-0 mt-2' id=" + questionObj.itemUlId + "></ul>" +
                    "</div>");


            }
            if (questionObj.type == "Nrep") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption'>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm ajout-radio' id=" + questionObj.ajouterBtnId + " /></div></div>" +
                    "<ul class='pl-0 mt-2' id=" + questionObj.itemUlId + ">" +
                    "<li class='form-inline justify-content-center mb-2 exemplechk'><div class='d-inline'><input type='checkbox' name='item' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='item1' disabled/></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li>" +
                    "<li class='form-inline justify-content-center mb-2 exemplechk'><div class='d-inline'><input type='checkbox' name='item' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='item2' disabled/></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li></ul></div></div></div></li>");

            }
            if (questionObj.type == "ValNum") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption' disabled>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div></div>" +
                    "<input id='textinput' name='textinput' type='text' class='form-control input-md'disabled>");


            }
            if (questionObj.type == "4niv") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption' disabled>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div></div>" +
                    "<div class='row justify-content-center mt-2'>" +
                    "<label class='radio-inline mr-2' for='radio'>" +
                    "<input type='radio' id='radio' value='1' disabled>" +
                    "peu satisfait" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio2'>" +
                    "<input type='radio' id='radio2' value='1' disabled>" +
                    "moyennement satisfait" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio3'>" +
                    "<input type='radio' id='radio3' value='1' disabled>" +
                    "satisfait" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio4'>" +
                    "<input type='radio' id='radio4' value='1' disabled>" +
                    "très satisfait" +
                    "</label></div>");
            }
            if (questionObj.type == "1rep") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption'>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm ajout-radio' id=" + questionObj.ajouterBtnId + " /></div></div>" +
                    "<ul class='pl-0 mt-2' id=" + questionObj.itemUlId + ">" +
                    "<li class='form-inline justify-content-center mb-2 exemple'><div class='d-inline'><input type='radio' name='item' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='item1' disabled/></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li>" +
                    "<li class='form-inline justify-content-center mb-2 exemple'><div class='d-inline'><input type='radio' name='item' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='item2' disabled/></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li></ul></div></div></div></li>");

            }
            if (questionObj.type == "TxtL") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption' disabled>" +
                    "<option value='1'>Colonne</option>" +
                    "<option selected value='2'>Ligne</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div>" +
                    "<div class='row h-25'><textarea id='textinput' name='textinput' rows='3' class='form-control' disabled></textarea></div>");

            }
            if (questionObj.type == "OuiNon") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption'>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div></div>" +
                    "<ul class='pl-0 mt-2' id=" + questionObj.itemUlId + ">" +
                    "<li class='form-inline justify-content-center mb-2'><div class='d-inline'><input type='radio' name='item' id='option1' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='Oui' disabled /></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li>" +
                    "<li class='form-inline justify-content-center mb-2'><div class='d-inline'><input type='radio' name='item' id='option1' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='Non' disabled /></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li></ul></div></div></div></li>");
            }
            if (questionObj.type == "OuiNonNsp") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId +" class='btn-sm graphOption'>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div></div>" +
                    "<ul class='pl-0 mt-2' id=" + questionObj.itemUlId + ">" +
                    "<li class='form-inline justify-content-center mb-2'><div class='d-inline'><input type='radio' name='item' id='option1' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='Oui' disabled /></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li>" +
                    "<li class='form-inline justify-content-center mb-2'><div class='d-inline'><input type='radio' name='item' id='option1' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='Non' disabled /></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li>" +
                    "<li class='form-inline justify-content-center mb-2'><div class='d-inline'><input type='radio' name='item' id='option1' class='d-inline ml-2' disabled /></div><div width='50' class='d-inline'><input class='form-control' type='text' value='Ne sais pas' disabled /></div><div class='d-inline ml-2'><button disabled><i href='#' class='fas fa-trash-alt'></i></button></div></li></ul></div></div></div></li>");

            }
            if (questionObj.type == "1a10") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption' disabled>" +
                    "<option value='Jauge'>Jauge</option>" +
                    "<option value='Colonnes'>Colonnes</option>" +
                    "<option value='Camembert'>Camembert</option>" +
                    "<option selected value='Barre'>Barre</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div></div>" +
                    "<div class='row justify-content-center mt-2'>" +
                    "<label class='radio-inline mr-2' for='radio'>" +
                    "<input type='radio' id='radio' value='1' disabled>" +
                    "1" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio2'>" +
                    "<input type='radio' id='radio2' value='1' disabled>" +
                    "2" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio3'>" +
                    "<input type='radio' id='radio3' value='1' disabled>" +
                    "3" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio4'>" +
                    "<input type='radio' id='radio4' value='1' disabled>" +
                    "4" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio5'>" +
                    "<input type='radio' id='radio5' value='1' checked='checked' disabled>" +
                    "5" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio6'>" +
                    "<input type='radio' id='radio6' value='1' disabled>" +
                    "6" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio7'>" +
                    "<input type='radio' id='radio7' value='1' disabled>" +
                    "7" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio8'>" +
                    "<input type='radio' id='radio8' value='1' disabled>" +
                    "8" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio9'>" +
                    "<input type='radio' id='radio9' value='1' disabled>" +
                    "9" +
                    "</label>" +
                    "<label class='radio-inline mr-2' for='radio10'>" +
                    "<input type='radio' id='radio10' value='1' disabled>" +
                    "10" +
                    "</label></div>");
            }
            if (questionObj.type == "TxtC") {
                $("#sortable").append("<li id=" + questionObj.questionId + "><div class='card'><div class='card-header'><div class='row justify-content-between align-items-center btn-sm'>" +
                    "<div class='align-self-end questIntitule' id=" + questionObj.intituleDivBId + ">" + questionObj.intitule + "</div>" +
                    "<div class='ml-auto align-self-start'>" +
                    "<i class='fa fa-chevron-up ml-3 rotate' data-toggle='collapse' data-target=" + questionObj.dataTarget + " aria-expanded='false' aria-controls='collapseExample'></i>" +
                    "<i class='fas fa-arrows-alt ml-2'></i>" +
                    "<i id=" + questionObj.trashIconId + " class='fas fa-trash-alt ml-2 trash' data-toggle='modal' data-target='#supprModal'></i></div></div></div>" +
                    "<div class='collapse' id=" + questionObj.targetId + ">" +
                    "<div class='card card-body'>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Intitulé de la question :</div>" +
                    "<div class='d-inline ml-2'><input class='form-control intituleTxtB' placeholder='Intitulé' type='text' id=" + questionObj.intituleTxtBId + " /></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Réponse obligatoire : </div>" +
                    "<div class='d-inline ml-2'><div class='form-check-inline'><label>" +
                    "<input class='form-check-input requis' type='radio' value='true' name=" + questionObj.questionId + " id=" + questionObj.requisOuiRadioId + " checked> Oui</label>" +
                    "<label><input class='form-check-input ml-5 requis' type='radio' value='false' name=" + questionObj.questionId + " id=" + questionObj.requisNonRadioId + "> Non</label></div></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Type de graphique :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<select id=" + questionObj.graphiqueId + " class='btn-sm graphOption' disabled>" +
                    "<option value='1'>Colonne</option>" +
                    "<option selected value='2'>Ligne</option></select></div></div>" +
                    "<div class='row mt-2 justify-content-center'>" +
                    "<div class='d-inline'>Valeurs possibles :</div>" +
                    "<div class='d-inline ml-2'>" +
                    "<input type='button' value='Ajouter un item' class='btn-sm' disabled /></div></div>" +
                    "<input id='textinput' name='textinput' type='text' class='form-control input-md'disabled>");


            }
        }
        // Génère le code html des valeurs possible de la question
        function CreerItemPreview(questionObj, userItem) {
            C("CreerPreviewItem");
            if (questionObj.type == "1repListe") {
                if (userItem != null) {
                    C("CreerPreviewItem 1Repliste");
                    userItem.itemPrev.id = userItem.idPreview;
                    userItem.itemPrev.lbl = "Lbl" + userItem.idPreview;
                    var idLabel = "#" + userItem.itemPrev.lbl;
                    var listItemId = "#" + questionObj.divListItemId;
                    userItem.itemPrev.codeHtml = "<option id=" + userItem.itemPrev.lbl + ">" + "option" + "</option>";
                    if (questionObj.requis == "false") {
                        $(listItemId).prop('required', false);
                    }
                    if (questionObj.requis == "true") {
                        $(listItemId).prop('required', true);
                    }
                    $(listItemId).append(userItem.itemPrev.codeHtml);

                }
            }
            if (questionObj.type == "Nrep") {
                if (userItem != null) {
                    C("CreerPreviewItem NRep");
                    userItem.itemPrev.id = userItem.idPreview;
                    userItem.itemPrev.lbl = "Lbl" + userItem.idPreview;
                    var idLabel = "#" + userItem.itemPrev.lbl;
                    var listItemId = "#" + questionObj.divListItemId;
                    C(questionObj.graphique);
                    userItem.itemPrev.codeHtml = "<div class='checkbox'>" +
                        "<input type='checkbox' name=" + userItem.itemPrev.groupName + " id=" + userItem.itemPrev.id + " class='mr-1'>" +
                        "<label id=" + userItem.itemPrev.lbl + " for=" + userItem.itemPrev.id + "></label></div> ";
                    $(listItemId).append(userItem.itemPrev.codeHtml);
                    //$(document.body).ready(function () {
                    //    if (questionObj.graphique == 1) {
                    //        $(idLabel).parent().toggleClass("d-inline", false);
                    //        $(idLabel).parent().toggleClass("checkbox", true);
                    //    }
                    //    if (questionObj.graphique == 2) {
                    //        $(idLabel).parent().toggleClass("checkbox", false);
                    //        $(idLabel).parent().toggleClass("d-inline mr-2", true);
                    //    }
                    //    if (questionObj.requis == "false") {
                    //        $(idLabel).children().prop('required', false);
                    //    }
                    //    if (questionObj.requis == "true") {
                    //        $(idLabel).children().prop('required', true);
                    //    }
                    //});
                }
                else {
                    C("Liste UserItems", questionObj.listUserItems);
                    questionObj.listUserItems = filter_array_values(questionObj.listUserItems);
                    for (var i = 0; i < questionObj.listUserItems.length; i++) {
                        var userItem = new UserItem();
                        var item = new Item();
                            userItem = questionObj.listUserItems[i];
                            item = userItem.itemPrev;
                            C(item);
                            var idInput = "#" + item.id;
                            //if (questionObj.graphique == 1) {
                            //    $(idInput).parent().toggleClass("d-inline", false);
                            //    $(idInput).parent().toggleClass("checkbox", true);
                            //}
                            //if (questionObj.graphique == 2) {
                            //    $(idInput).parent().toggleClass("checkbox", false);
                            //    $(idInput).parent().toggleClass("d-inline mr-2", true);
                            //}
                            //if (questionObj.requis == "false") {
                            //    $(idInput).prop('required', false);
                            //}
                            //if (questionObj.requis == "true") {
                            //    $(idInput).prop('required', true);
                            //}
                    }

                }

            }
            if (questionObj.type == "1rep") {
                C("CreerPreviewItem 1Rep");
                C(questionObj);
                if (userItem != null) {
                    C("item prev lbl ", userItem.itemPrev.lbl);

                        C("Item creation preview")
                        userItem.itemPrev.id = userItem.idPreview;
                        userItem.itemPrev.lbl = "Lbl" + userItem.idPreview;
                        userItem.itemPrev.codeHtml = "<div class='radio'>" +
                            "<input type='radio' name=" + userItem.itemPrev.groupName + " id=" + userItem.itemPrev.id + " class='mr-1' required>" +
                            "<label id=" + userItem.itemPrev.lbl + " for=" + userItem.itemPrev.id + "></label></div> ";


                    var idLabel = "#" + userItem.itemPrev.lbl;
                    C(questionObj.graphique);
                    let idListItem = "#" + questionObj.divListItemId;
                    $(idListItem).append(userItem.itemPrev.codeHtml);
                    C("Etat requis : ", questionObj.requis);
                    $(document.body).ready(function () {
                        if (questionObj.graphique == 1) {
                            $(idLabel).parent().toggleClass("d-inline", false);
                            $(idLabel).parent().toggleClass("radio", true);
                        }
                        if (questionObj.graphique == 2) {
                            $(idLabel).parent().toggleClass("radio", false);
                            $(idLabel).parent().toggleClass("d-inline mr-2", true);
                        }
                        if (questionObj.requis == "false") {
                            C("requis false")
                            $(idLabel).parent().prop('required', false);
                        }
                        if (questionObj.requis == "true") {
                            $(idLabel).parent().prop('required', true);
                        }
                    });
                    }
                    else {
                    C("Liste UserItems", questionObj.listUserItems);
                    questionObj.listUserItems = filter_array_values(questionObj.listUserItems);
                    for (var i = 0; i < questionObj.listUserItems.length; i++) {
                        var userItem = new UserItem();
                        var item = new Item();
                        userItem = questionObj.listUserItems[i];
                        item = userItem.itemPrev;
                        C(item);
                        var idInput = "#" + item.id;
                        if (questionObj.graphique == 1) {
                            $(idInput).parent().toggleClass("d-inline", false);
                            $(idInput).parent().toggleClass("checkbox", true);
                        }
                        if (questionObj.graphique == 2) {
                            $(idInput).parent().toggleClass("checkbox", false);
                            $(idInput).parent().toggleClass("d-inline mr-2", true);
                        }
                        if (questionObj.requis == "false") {
                            $(idInput).prop('required', false);
                        }
                        if (questionObj.requis == "true") {
                            $(idInput).prop('required', true);
                        }
                    }

                }
            }
            C("Liste UserItems après ajout :", questionObj.listUserItems);
        }
        // Génère le code html pour l'aperçu de la question
        function CreerPreview(questionObj) {
            C("objet recup pour preview", questionObj);
            console.log("creer preview");
            var qPreview = "#" + questionObj.questionPreviewId;
            C("Div q preview", qPreview);
            var groupName;
            if (questionObj.type == "1repListe") {
                questionObj.listItems = [''];
                groupName = "radios" + questionObj.questionId;
                C("Graphique", questionObj.graphique);
                var itemExemple1 = new Item(questionObj.questionId);
                var itemExemple2 = new Item(questionObj.questionId);
                if (questionObj.modifUser == true) {
                    $(document.body).ready(function () {
                        var idDivPrev = "#" + questionObj.questionPreviewId;
                        $(idDivPrev).find("label.control-label").html('');
                        $(idDivPrev).find("label.control-label").html(questionObj.intitule);
                    })
                }
                if (questionObj.modifUser == false) {
                    $(qPreview).remove();
                    C("ID itemExemple", itemExemple2.id, itemExemple1.id)
                    questionObj.listItems.push(itemExemple1, itemExemple2);
                    questionObj.codeHtml = "<div class='tab'><div id= " + questionObj.questionPreviewId + " class='form-group' >" +
                        "<label class='col-md-4 control-label'>" + questionObj.intitule + "</label>" +
                        "<div class='col-md-4'>" +
                        "<select id=" + questionObj.divListItemId + " name='selectbasic' class='form-control' required>" +
                        "</div>"+
                        "</select>"+
                        "</div></fieldset></div>";
                    AppendPrev(questionObj);

                    $(document.body).ready(function () {
                        itemExemple1 = questionObj.listItems[1];
                        itemExemple2 = questionObj.listItems[2];
                        var idLabel1 = "#" + itemExemple1.lblId;
                        var idLabel2 = "#" + itemExemple2.lblId;
                        if (questionObj.graphique == 2) {
                            C("ENTREE GRAPH 2");
                            C(itemExemple2.lblId);
                            $(idLabel1).parent().toggleClass("checkbox", false);
                            $(idLabel1).parent().toggleClass("d-inline mr-2", true);
                            $(idLabel2).parent().toggleClass("checkbox", false);
                            $(idLabel2).parent().toggleClass("d-inline mr-2", true);

                            if (questionObj.requis == "false") {

                                $(idLabel1).children().prop('required', false);
                            }
                            else {
                                $(idLabel1).children().prop('required', true);
                            }
                        }
                        if (questionObj.graphique == 1) {
                            C("Graphique", questionObj.graphique);
                            $(idLabel1).parent().toggleClass("d-inline", false);
                            $(idLabel1).parent().toggleClass("checkbox", true);
                            $(idLabel2).parent().toggleClass("d-inline", false);
                            $(idLabel2).parent().toggleClass("checkbox", true);

                            if (questionObj.requis == "false") {
                                $(idLabel1).children().prop('required', false);
                            }
                            else {
                                $(idLabel1).children().prop('required', true);
                            }
                        }

                    });

                }
                else {

                }
            }
            if (questionObj.type == "Nrep") {
                questionObj.listItems = [''];
                groupName = "radios" + questionObj.questionId;
                C("Graphique", questionObj.graphique);
                var itemExemple1 = new Item(questionObj.questionId);
                var itemExemple2 = new Item(questionObj.questionId);
                if (questionObj.modifUser == true) {
                    $(document.body).ready(function () {
                        var idDivPrev = "#" + questionObj.questionPreviewId;
                        $(idDivPrev).find("label.control-label").html('');
                        $(idDivPrev).find("label.control-label").html(questionObj.intitule);
                    })
                }
                if (questionObj.modifUser == false) {
                    $(qPreview).remove();
                    C("ID itemExemple", itemExemple2.id, itemExemple1.id)
                    questionObj.listItems.push(itemExemple1, itemExemple2);
                    questionObj.codeHtml = "<div class='tab'><div id= " + questionObj.questionPreviewId + " class='form-group' > <fieldset id=" + groupName + ">" +
                        "<label class='col-md-4 control-label' for=" + itemExemple1.groupName + ">" + questionObj.intitule + "</label>" +
                        "<div class='col-md-4'>" +
                        "<div id=" + questionObj.divListItemId + ">" +
                        "<div class='checkbox-group required'>"+
                        "<div class='exemplechk'>" +
                        "<div class='checkbox'>" +
                        "<input type='checkbox' name=" + itemExemple1.groupName + " id=" + itemExemple1.id + ">" +
                        "<label class='checkbox ml-1' id=" + itemExemple1.lblId + " for=" + itemExemple1.id + ">" +
                        "choix 1" +
                        "</label>"+
                        "</div > " +
                        "<div class='checkbox'>" +
                        "<input type='checkbox' name=" + itemExemple2.groupName + " id=" + itemExemple2.id + ">" +
                        "<label class='checkbox ml-1' id=" + itemExemple2.lblId + " for=" + itemExemple2.id + ">" +
                        "choix 1" +
                        "</label>" +
                        "</div > " +
                        "</div>" +
                        "</div></div></fieldset></test>";
                    AppendPrev(questionObj);

                    $(document.body).ready(function () {
                        itemExemple1 = questionObj.listItems[1];
                        itemExemple2 = questionObj.listItems[2];
                        var idLabel1 = "#" + itemExemple1.lblId;
                        var idLabel2 = "#" + itemExemple2.lblId;
                        var checkGroup = "#" + questionObj.divListItemId;
                        if (questionObj.requis == "false") {
                            $(checkGroup).children().toggleClass('checkbox-group');
                        }
                        else {
                            $(checkGroup).children().toggleClass('checkbox-group required');
                        }

                    });

                }
                else {

                }
            }
            if (questionObj.type == "4niv")
            {
                $(qPreview).remove();
                var item1 = new Item(questionObj.questionId);
                var item2 = new Item(questionObj.questionId);
                var item3 = new Item(questionObj.questionId);
                var item4 = new Item(questionObj.questionId);
                questionObj.listItems = [''];
                questionObj.listItems.push(item1, item2, item3, item4);
                if (questionObj.requis == "false") {
                    questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'><fieldset id=" + groupName + ">" +
                        "<label class='col-md-4 control-label' for=" + item1.groupName + ">" + questionObj.intitule + "</label>" +
                        "<div class='col-md-4'>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item1.groupName + " id=" + item1.id + " value='1'>" +
                        "<label for=" + item1.id + "> peu satisfait </label >" +
                        "</div>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item2.groupName + " id=" + item2.id + " value='2'>" +
                        "<label for=" + item2.id + "> moyennement satisfait </label >" +
                        "</div>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item3.groupName + " id=" + item3.id + " value='3'>" +
                        "<label for=" + item3.id + "> satisfait </label >" +
                        "</div>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item4.groupName + " id=" + item4.id + " value='4'>" +
                        "<label for=" + item4.id + "> très satisfait </label >" +
                        "</div>" +
                        "</div></div></fieldset></div></div>"
                }
                else {
                    questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'><fieldset id=" + groupName + ">" +
                        "<label class='col-md-4 control-label' for=" + item1.groupName + ">" + questionObj.intitule + "</label>" +
                        "<div class='col-md-4'>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item1.groupName + " id=" + item1.id + " value='1' required>" +
                        "<label for=" + item1.id + "> peu satisfait </label >" +
                        "</div>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item2.groupName + " id=" + item2.id + " value='2'>" +
                        "<label for=" + item2.id + "> moyennement satisfait </label >" +
                        "</div>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item3.groupName + " id=" + item3.id + " value='3'>" +
                        "<label for=" + item3.id + "> satisfait </label >" +
                        "</div>" +
                        "<div class='radio'>" +
                        "<input type='radio' class='mr-1' name=" + item4.groupName + " id=" + item4.id + " value='4'>" +
                        "<label for=" + item4.id + "> très satisfait </label >" +
                        "</div>" +
                        "</div></div></fieldset></div></div>"

                }
                AppendPrev(questionObj);
            }
            if (questionObj.type == "ValNum") {
                $(qPreview).remove();
                var itemTxtC = new Item();
                itemTxtC.id = "TxtC" + codeQuestion;
                var inputId = "#" + itemTxtC.id;
                questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                    "<label class='col-md-4 control-label' for=" + itemTxtC.id + ">" + questionObj.intitule +
                    "<input id =" + itemTxtC.id + " type ='number' class='form-control input-md' required>" +
                    "</label ></div></div>";
                AppendPrev(questionObj);
                $(document.body).on(function () {
                    if (questionObj.requis == "false") {
                        $(inputId).prop('required', false);
                    }
                    else {
                        $(inputId).prop('required', true);
                    }
                });
            }
            if (questionObj.type == "1rep") {
                questionObj.listItems = [''];
                groupName = "radios" + questionObj.questionId;
                C("Graphique", questionObj.graphique);
                var itemExemple1 = new Item(questionObj.questionId);
                var itemExemple2 = new Item(questionObj.questionId);
                if (questionObj.modifUser == true) {
                    $(document.body).ready(function () {
                        var idDivPrev = "#" + questionObj.questionPreviewId;
                        $(idDivPrev).find("label.control-label").html('');
                        $(idDivPrev).find("label.control-label").html(questionObj.intitule);
                    })
                }
                if (questionObj.modifUser == false) {
                    $(qPreview).remove();
                    C("ID itemExemple", itemExemple2.id, itemExemple1.id)
                    questionObj.listItems.push(itemExemple1, itemExemple2);
                    questionObj.codeHtml = "<div class='tab'><div id= " + questionObj.questionPreviewId + " class='form-group' > <fieldset id=" + groupName + ">" +
                        "<label class='col-md-4 control-label' for=" + itemExemple1.groupName + ">" + questionObj.intitule + "</label>" +
                        "<div class='col-md-4'>" +
                        "<div id=" + questionObj.divListItemId +">" +
                        "<div class='exemple'>" +
                        "<div class='radio'>" +
                        "<label class='radio' id=" + itemExemple1.lblId + " for=" + itemExemple1.id + ">" +
                        "<input type='radio' name=" + itemExemple1.groupName + " id=" + itemExemple1.id + " required>" +
                        "choix 1" +
                        "</label></div>" +
                        "<div class='radio'>" +
                        "<label class='radio' id=" + itemExemple2.lblId + " for=" + itemExemple2.id + ">" +
                        "<input type='radio' name=" + itemExemple2.groupName + " id=" + itemExemple2.id + ">" +
                        "choix 2" +
                        "</label></div>" +
                        "</div></div></fieldset></div>";
                    AppendPrev(questionObj);

                    $(document.body).ready(function () {
                        itemExemple1 = questionObj.listItems[1];
                        itemExemple2 = questionObj.listItems[2];
                        var idLabel1 = "#" + itemExemple1.lblId;
                        var idLabel2 = "#" + itemExemple2.lblId;
                        if (questionObj.graphique == 2) {
                            C("ENTREE GRAPH 2");
                            C(itemExemple2.lblId);
                            $(idLabel1).parent().toggleClass("radio", false);
                            $(idLabel1).parent().toggleClass("d-inline mr-2", true);
                            $(idLabel2).parent().toggleClass("radio", false);
                            $(idLabel2).parent().toggleClass("d-inline mr-2", true);

                            if (questionObj.requis == "false") {

                                $(idLabel1).children().prop('required', false);
                            }
                            else {
                                $(idLabel1).children().prop('required', true);
                            }
                        }
                        if (questionObj.graphique == 1) {
                            C("Graphique", questionObj.graphique);
                            $(idLabel1).parent().toggleClass("d-inline", false);
                            $(idLabel1).parent().toggleClass("radio", true);
                            $(idLabel2).parent().toggleClass("d-inline", false);
                            $(idLabel2).parent().toggleClass("radio", true);

                            if (questionObj.requis == "false") {
                                $(idLabel1).children().prop('required', false);
                            }
                            else {
                                $(idLabel1).children().prop('required', true);
                            }
                        }

                    });

                }
            }
            if (questionObj.type == "TxtL") {
                $(qPreview).remove();
                var itemTxtL = new Item();
                itemTxtL.id = "TxtL" + codeQuestion;
                if (questionObj.requis == "false") {
                    questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                        "<label class= control-label col-md-4' for=" + itemTxtL.itemId + ">" + questionObj.intitule +
                        "<textarea  id =" + itemTxtL.id + " rows='3' class='form-control'></textarea>" +
                        "</label >" +
                        "</div></div>"
                }
                else {
                    questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                        "<label class=' control-label col-md-4' for=" + itemTxtL.id + ">" + questionObj.intitule +
                        "<textarea id =" + itemTxtL.id + " rows='3' class='form-control' required></textarea>" +
                        "</label ></div></div>"
                }
                AppendPrev(questionObj);
            }
            if (questionObj.type == "TxtC") {
                $(qPreview).remove();
                var itemTxtC = new Item();
                itemTxtC.id = "TxtC" + codeQuestion;
                if (questionObj.requis == "false") {
                    questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                        "<label class='col-md-4 control-label' for=" + itemTxtC.id + ">" + questionObj.intitule +
                        "<input id =" + itemTxtC.id + " name ='textinput' type ='text' class='form-control input-md'>" +
                        "</label ></div></div>"
                }
                else {
                    questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                        "<label class='col-md-4 control-label' for=" + itemTxtC.id + ">" + questionObj.intitule +
                        "<input id =" + itemTxtC.id + " type ='text' class='form-control input-md' required>" +
                        "</label ></div></div>"
                }
                AppendPrev(questionObj);
            }
            if (questionObj.type == "OuiNon") {
                $(qPreview).remove();
                let itemOui = new Item(questionObj.questionId);
                let itemNon = new Item(questionObj.questionId);
                C("if ouiNon preview");
                itemOui.id = "Oui" + questionObj.questionId + String(Math.floor((Math.random() * 100) + 1));
                itemOui.itemName = questionObj.questionId+"-radio" ;
                itemNon.id = "Non" + questionObj.questionId + String(Math.floor((Math.random() * 100) + 1));
                itemNon.itemName = questionObj.questionId + "-radio";
                questionObj.listItems = [''];
                questionObj.listItems.push(itemNon);
                questionObj.listItems.push(itemOui);
                C("avant le if", questionObj.graphique);
                questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                    "<label class='col-md-4 control-label' for=" + questionObj.questionId + ">" + questionObj.intitule + "</label>" +
                    "<div class='col-md-4'>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + itemOui.itemName + " id=" + itemOui.id + " value='oui' required>" +
                    "<label for=" + itemOui.id + "> Oui </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + itemNon.itemName + " id=" + itemNon.id + " value='non' >" +
                    "<label for=" + itemNon.id + "> Non </label >" +
                    "</div>" +
                    "</div>" +
                    "</div></div>";
                AppendPrev(questionObj);
                $(document.body).ready(function () {
                    if (questionObj.requis == "false") {
                        var itemId = "#" + itemOui.id;
                        C(itemId);
                        $(itemId).prop('required', false);
                    }
                    if (questionObj.requis == "true") {
                        var itemId = "#" + itemOui.id;
                        $(itemId).prop('required', true);
                    }
                });
            }
            if (questionObj.type == "OuiNonNsp")
            {
                $(qPreview).remove();
                let itemOui = new Item(questionObj.questionId);
                let itemNon = new Item(questionObj.questionId);
                var itemNeSaisPas = new Item(questionObj.questionId);
                itemOui.id = "Oui" + questionObj.questionId;
                itemOui.itemName = questionObj.questionId + "-radio";
                itemNon.id = "Non" + questionObj.questionId;
                itemNon.itemName = questionObj.questionId + "-radio" ;
                itemNeSaisPas.id = "NeSaisPas" + questionObj.questionId;
                itemNeSaisPas.itemName = questionObj.questionId + "-radio";
                questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'>" +
                    "<label class='col-md-4 control-label' for=" + questionObj.questionId + ">" + questionObj.intitule + "</label>" +
                    "<div class='col-md-4'>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + itemOui.itemName + " id=" + itemOui.id + " value='oui' required>" +
                    "<label for=" + itemOui.id + "> Oui </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + itemNon.itemName + " id=" + itemNon.id + " value='non' >" +
                    "<label for=" + itemNon.id + "> Non </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + itemNeSaisPas.itemName + " id=" + itemNeSaisPas.id + " value='nesaispas' >" +
                    "<label for=" + itemNeSaisPas.id + "> Ne sais pas </label >" +
                    "</div>" +
                    "</div>" +
                    "</div></div>";
                AppendPrev(questionObj);
                $(document.body).ready(function () {
                    if (questionObj.requis == "false") {
                        var itemId = "#" + itemNon.id;
                        $(itemId).prop('required', false);
                    }
                    if (questionObj.requis == "true") {
                        var itemId = "#" + itemNon.id;
                        $(itemId).prop('required', true);
                    }
                });
            }
            if (questionObj.type == "1a10")
            {
                $(qPreview).remove();
                var item1 = new Item(questionObj.questionId);
                var item2 = new Item(questionObj.questionId);
                var item3 = new Item(questionObj.questionId);
                var item4 = new Item(questionObj.questionId);
                var item5 = new Item(questionObj.questionId);
                var item6 = new Item(questionObj.questionId);
                var item7 = new Item(questionObj.questionId);
                var item8 = new Item(questionObj.questionId);
                var item9 = new Item(questionObj.questionId);
                var item10 = new Item(questionObj.questionId);
                groupName = "radios" + questionObj.questionId;
                questionObj.listItems = [''];
                questionObj.listItems.push(item1, item2, item3, item4, item5, item6, item7, item8, item9, item10);
                C(questionObj.listItems);
                C(questionObj.requis);
                var radioId = "#" + item1.id;
                questionObj.codeHtml = "<div class='tab'><div id=" + questionObj.questionPreviewId + " class='form-group'><fieldset id=" + groupName + ">" +
                    "<label class='col-md-4 control-label' for=" + groupName + ">" + questionObj.intitule + "</label>" +
                    "<div class='col-md-4'>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item1.groupName + " id=" + item1.id + " value='1' required>" +
                    "<label for=" + item1.id + "> 1 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item2.groupName + " id=" + item2.id + " value='2'>" +
                    "<label for=" + item2.id + "> 2 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item3.groupName + " id=" + item3.id + " value='3'>" +
                    "<label for=" + item3.id + "> 3 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item4.groupName + " id=" + item4.id + " value='4'>" +
                    "<label for=" + item4.id + "> 4 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item5.groupName + " id=" + item5.id + " value='5'>" +
                    "<label for=" + item5.id + "> 5 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item6.groupName + " id=" + item6.id + " value='6'>" +
                    "<label for=" + item6.id + "> 6 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item7.groupName + " id=" + item7.id + " value='7'>" +
                    "<label for=" + item7.id + "> 7 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item8.groupName + " id=" + item8.id + " value='8'>" +
                    "<label for=" + item8.id + "> 8 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item9.groupName + " id=" + item9.id + " value='9'>" +
                    "<label for=" + item9.id + "> 9 </label >" +
                    "</div>" +
                    "<div class='radio'>" +
                    "<input type='radio' class='mr-1' name=" + item10.groupName + " id=" + item10.id + " value='10'>" +
                    "<label for=" + item10.id + "> 10 </label >" +
                    "</div>" +
                    "</div></div></fieldset></div></div>";
                AppendPrev(questionObj);
                $(document.body).ready(function () {
                    if (questionObj.requis == "false") {
                        $(radioId).prop('required', false);
                    }
                    else {
                        $(radioId).prop('required', true);
                    }
                });


            }
        }
        // Crée l'aperçu de la question
        function AppendPrev(questionObj) {
            //if (true) {
            //    AjouterQuestionCookie(questionObj);
            //}
            var divPosPrevId = "#" + questionObj.divPosPrev;
            C("avant append")
            C("Id de la balise de position", divPosPrevId);
            C($(divPosPrevId).children().length);
            C($(divPosPrevId));
            $(document.body).ready(function () {
                if ($(divPosPrevId).length == 0) {
                    C("la balise de position n'existe pas.");
                    let code = "<div id=" + questionObj.divPosPrev + ">" + questionObj.codeHtml + "</div>";
                    C(code);
                    $("#previewQuestions").append(code);
                    return;
                }
                else if ($(divPosPrevId).length != 0) {
                    C("la balise de position existe.");
                    $(divPosPrevId).append(questionObj.codeHtml);
                }
            });
        }

        function filter_array_values(arr) {
            arr = arr.filter(isEligible);
            return arr;
        }
        function isEligible(value) {
            if (value !== false || value !== null || value !== 0 || value !== "") {
                return value;
            }
        }
        function getQuestionnaire(id) {

        }
        function SetCookieQuestionnaire(questionnaire) {
            if (document.cookie) {
                document.cookie = "Questionnaire=;expires=Thu, 01 Jan 1970 00: 00: 00 UTC; path=/";
            }
            let questionnaireJson = JSON.stringify(questionnaire);
            C("Cookie quest json :",questionnaireJson);
            document.cookie = "Questionnaire="+ questionnaireJson + ";expires=10; path=/";
            C(document.cookie);
        }

        function EnregistrerQuestionnaire(questionnaire) {
            let questionnaireJson = JSON.stringify(questionnaire);
            C(questionnaireJson);
        $.ajax({
                url: '@Url.Action("CreerQuestionnaire", "OPS")',
            data: { "data": questionnaireJson },
                type: 'POST',
            dataType: 'application/json',
                success: function (response) {
                    if (response.data != null) {

                    }
                    else {

                    }
                },
                error: function (xhr, status, error) {

                }
        });

        }
        function AddQuestionObj(questionObj) {
            let QuestionObjJson = JSON.stringify(questionObj);
        $.ajax({
                url: '@Url.Action("AddQuestionObj", "OPS")',
            data: { "query": QuestionObjJson },
                type: 'POST',
            dataType: 'application/json',
                success: function (response) {
                    if (response.data != null) {

                    }
                    else {

                    }
                },
                error: function (xhr, status, error) {

                }
        });

        }
        function GetQuestionObj(codeQuestion) {
            $.ajax({
                url: '@Url.Action("GetQuestionObj", "OPS")',
                data: { "query": codeQuestion },
                type: 'POST',
            dataType: 'application/json',
                success: function (response) {
                    if (response.data != null) {
                        questionObj = response.data;
                    }
                    else {

                    }
                },
                error: function (xhr, status, error) {

                }
            });
        }
        function MakeQuestionObj() {
            class QuestionObj {
                constructor() {
                    this.type = '';
                    this.sousType = '';
                    this.choixRequis = '';
                    this.questionId = null;
                    this.intitule = '';
                    this.dataTarget = '';
                    this.TargetId = '';
                    this.intituleTxtBId = '';
                    this.intituleDivBId = '';
                    this.requisOuiRadioId = '';
                    this.requisNonRadioId = '';
                    this.requisRadioName = '';
                    this.requis = '';
                    this.ddlId = '';
                    this.ajoutSupprChoix = '';
                    this.ajouterBtnId = '';
                    this.supprBtnId = '';
                    this.trashBtnId = '';
                    this.graphique = '';
                    this.graphiqueLigneId = '';
                    this.graphiqueColId = '';
                    this.codeHtml = '';
                    this.questionPreviewId = '';
                    this.listItems = [''];
                }
            }
            return QuestionObj;
        }
        // Objets de l'interface
        function QuestionObj(type, choixRequis, ajoutSupprChoix, intitule, codeQuestion, numQ) {
            this.numQ = numQ;
            this.type = type;
            this.sousType = '';
            this.choixRequis = choixRequis;
            this.questionId = codeQuestion;
            this.intitule = intitule;
            this.dataTarget = "#quest" + codeQuestion + "Param";
            this.targetId = "quest" + codeQuestion + "Param";
            this.intituleTxtBId = "intitule" + codeQuestion + "TxtB";
            this.intituleDivBId = "intitule" + codeQuestion + "Div";
            this.requisOuiRadioId = "reqOui" + codeQuestion + "Radio";
            this.requisNonRadioId = "reqNon" + codeQuestion + "Radio";
            this.requisRadioName = "ouiNon" + codeQuestion;
            this.requis = '';
            this.ddlId = "item" + codeQuestion + "Ddl";
            this.ajoutSupprChoix = ajoutSupprChoix;
            this.ajouterBtnId = "ajouter" + codeQuestion + "Btn";
            this.supprBtnId = "suppr" + codeQuestion + "Btn";
            this.trashIconId = "trash" + codeQuestion + "Icon";
            this.graphique = 1;
            this.graphiqueId = "graph" + codeQuestion + "div";
            this.questionPreviewId = "questionPreview" + codeQuestion;
            this.graphiqueLigneId = '';
            this.graphiqueColId = '';
            this.codeHtml = '';
            this.divPosPrev = "posPrev" + codeQuestion;
            this.itemUlId = "item" + codeQuestion + "Ul";
            this.itemLiId = "item" + codeQuestion;
            this.modifUser = false;
            this.divListItemId = "listItem" + codeQuestion;
            this.listItems = [''];
            this.listUserItems = [''];
        }
        function Item(codeQuestion) {
            this.id = codeQuestion + "Item" + String(Math.floor((Math.random() * 1000) + 1));
            this.lbl = '';
            this.lblId = codeQuestion + "Item" + String(Math.floor((Math.random() * 1000) + 1))
            this.name = '';
            this.intitule = '';
            this.groupName = "radios" + codeQuestion;
            this.codeHtml = '';
        }
        function UserItem(codeQuestion) {
            this.id = codeQuestion + "userItem" +  String(Math.floor((Math.random() * 100) + 1));
            this.idPreview = "itemPrev"+ codeQuestion  + String(Math.floor((Math.random() * 1000) + 1));
            this.type = '';
            this.fakeId = 1;
            this.txtBId = "intituleItem" + codeQuestion + "TxtB" + String(Math.floor((Math.random() * 1000) + 1));
            this.ulId = '';
            this.intitule = '';
            this.codeHtml = '';
            this.name = '';
            this.itemPrev = {};
        }
        // Foncrion d'extraction de l' id de la question en utilisant en entrée un id d'un élément du dom
        function ExtraireCodeQuestion(Id = '') {

        if (Id.match(/(\d+)/)) {
            var code = '';
            code = Id.match(/(\d+)/);
            return code[0];
        }
        else {

            return false;
        }
        }
     });
    //$(function () {
    //    $('#sortable').sortable({
    //        update: function (event, ui) {
    //            var productOrder = $(this).sortable('toArray').toString();
    //            $("#ordre").text(productOrder);
    //        }
    //    });
    //});

    //$('.drag').draggable({
    //    containment: '#limitation',
    //    snap: '.draggable',
    //    revert: true
    //});
    //$('.drop').droppable();

</script>
